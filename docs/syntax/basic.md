# 基础语法
> [!NOTE|label:写在前面]
> 以下所有的符号均为半角字符。
## 大结构
一个脚本文件由若干个代码块组成，每个代码块由一个匹配输入和若干语句组成。\
代码块的第一行是匹配的正则表达式，称其为代码头\
往后为执行语句。\
代码块之间用空行隔开。

用户输入之后，程序会从上到下依次匹配各代码头，找到第一个匹配的代码头后，执行对应的代码块。\

## 输入
采用正则表达式匹配。按照捕获组进行匹配（即`()`中的东西），自动存入`%括号n%`中，其中`n`遵循Java正则表达式的捕获顺序。\
特别的，`%括号0%`和`%参数-1%`为输入的全部内容。
用户的输入将会从上到下依次匹配各代码头，因此注意多个代码头之间是否存在包含关系。

## 输出
除赋值和一些功能性语句外，所有语句均视为输出。\
支持`\n`，`\r`的换行转义，其余均不支持。\

## 变量
引用变量时，使用`%变量名%`的形式，多个变量在语句中并列解析。\

为变量赋值时，有两种方式：

- `变量名:值`，其中`变量名`**只能为单个字符**，`值`可以为任意值。\
- 用函数赋值，`$变量 变量名 值$`，这里变量名不做限制。但是函数不支持嵌套

为避免歧义，命名变量时，不能使用`%`符号。

## 函数
> 暂时不支持用户自定义函数。以后会进行补充

函数的调用方式为：
```nyaplus
$函数名 参数1 参数2 ...$
```
如果参数中包含空格，需要用双引号`"`括起来。\
超出参数数量的部分会合并入最后一个参数中，（包含空格）\
例如，如下函数只接受两个参数，但调用时写作了：
```nyaplus
$函数 1 2 3$
```
那么传入的两个参数分别是`1`和`2 3`。

> [!WARNING]
> 函数和变量都是仅支持并排调用，不支持嵌套调用。

## 算数表达式
算术表达式由`[]`括起来。\
支持的运算符：`+` `-` `*` `/` `%` `^`\
符号优先级：`^`>`*` `/` `%`>`+` `-`\
支持括号指定优先级。

原则上支持浮点数计算，但是尽量还是推荐使用整数。
当计算结果距离最近的整数小于0.01时，会被自动就近取整。

## 注释
仅支持单行注释，每一行`##`后面的字符均视为注释。
在一行内，注释与代码块之间的空白字符将被忽略。


集中写一次示例：
```nyaplus
## 我的第一个NyaPlus程序

开始
Hello World!  ##输出Hello World!
## 这是一种神秘仪式，每当学习一门新语言的时候必不可少的（

测试(\d+) (\d+) (\d+)
a:12
b:16
三个数之和为：[%括号1%+%括号2%+%括号3%]\n    ##注释前面的空格会被忽略
##-------注释也可以占据一行--------
##                                         可以用注释在一个代码块中插入空行，这样好看
三个数之积为：[%括号1%*%括号2%*%括号3%]\n    ##注释不会隔断代码块
a+b=[%a%+%b%]\n
```






